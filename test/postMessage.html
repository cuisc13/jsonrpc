<!DOCTYPE html>
<html lang="zh">
    <head>
        <script type="text/javascript" src="../jsonRpc.js" ></script>
        
    </head>
    <body>
        <iframe src='./domain1.html' id="domainIframe1" ></iframe>
        <script type="text/javascript">
            window.addEventListener("message", function (event) {
                console.log('get: '+ JSON.stringify(event.data))
                jsonRpc.onMessage(event.data);
            }, false);

            var pageName = 'main';
            jsonRpc.addCommand('sayName', function () {
                return pageName;
            })
            var dIframe1Elm = document.getElementById('domainIframe1');
            dIframe1Elm.addEventListener('load', function () {
                jsonRpc._send = function (obj, mess) {
                    console.log('send: '+ JSON.stringify(obj))
                    dIframe1Elm.contentWindow.postMessage(obj, '*')
                }
                jsonRpc.exec('sayName', function (str) {
                    console.log(str);
                })
            }, false);
            
        </script>
    </body> 
</html>
